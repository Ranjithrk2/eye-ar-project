<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Human Eye AR Interactive</title>

<!-- AFRAME -->
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>

<!-- ARJS -->
<script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

<style>
body {
    margin: 0;
    overflow: hidden;
    font-family: Arial;
}

#info {
    position: absolute;
    bottom: 20px;
    width: 100%;
    text-align: center;
    color: white;
    background: rgba(0,0,0,0.6);
    padding: 10px;
    font-size: 16px;
}
</style>

</head>

<body>

<div id="info">
ðŸ“± Point camera at HIRO marker â€¢ Drag to Rotate â€¢ Pinch to Zoom
</div>

<a-scene
embedded
vr-mode-ui="enabled: false"
arjs="sourceType: webcam; debugUIEnabled: false;"
renderer="logarithmicDepthBuffer: true;"
>

<a-assets>
    <a-asset-item id="eyeModel" src="models/eye.glb"></a-asset-item>
</a-assets>

<a-marker preset="hiro">

    <a-entity
        id="model"
        gltf-model="#eyeModel"
        position="0 0 0"
        rotation="-90 0 0"
        scale="0.5 0.5 0.5">
    </a-entity>

</a-marker>

<a-entity camera></a-entity>

</a-scene>

<script>
const model = document.getElementById("model");

let scale = 0.5;
let rotationY = 0;

let lastDistance = null;

// ROTATE
document.addEventListener("touchmove", function (e) {

    if (e.touches.length == 1) {

        rotationY += e.touches[0].movementX || 1;

        model.setAttribute(
            "rotation",
            `-90 ${rotationY} 0`
        );

    }

});

// PINCH ZOOM
document.addEventListener("touchmove", function (e) {

    if (e.touches.length == 2) {

        let dx = e.touches[0].clientX - e.touches[1].clientX;
        let dy = e.touches[0].clientY - e.touches[1].clientY;

        let distance = Math.sqrt(dx * dx + dy * dy);

        if (lastDistance) {

            if (distance > lastDistance) scale += 0.01;
            else scale -= 0.01;

            scale = Math.max(0.2, Math.min(2, scale));

            model.setAttribute(
                "scale",
                `${scale} ${scale} ${scale}`
            );
        }

        lastDistance = distance;
    }

});

document.addEventListener("touchend", function () {
    lastDistance = null;
});
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Futuristic AR Eye Learning</title>

<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

<style>
body {
  margin:0;
  overflow:hidden;
  background:#050505;
  font-family: 'Orbitron', sans-serif;
}

a-text {
  text-shadow: 0 0 10px cyan, 0 0 20px cyan, 0 0 30px cyan;
}

@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap');
</style>
</head>

<body>

<a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">

<a-marker preset="hiro" id="marker">

  <!-- CENTER EYE -->
  <a-entity id="eyeModel"
    gltf-model="models/eye.glb"
    position="0 0 0"
    rotation="0 0 0"
    scale="3 3 3">
  </a-entity>


  <!-- ===== ORBIT BUTTONS ===== -->

  <a-sphere id="corneaBtn" class="clickable part"
    position="-1.4 0.8 0"
    radius="0.18"
    color="#00ffff" opacity="0.8">
    <a-text value="Cornea" align="center" position="0 0.3 0"></a-text>
  </a-sphere>

  <a-sphere id="irisBtn" class="clickable part"
    position="1.4 0.8 0"
    radius="0.18"
    color="#00ffff" opacity="0.8">
    <a-text value="Iris" align="center" position="0 0.3 0"></a-text>
  </a-sphere>

  <a-sphere id="lensBtn" class="clickable part"
    position="-1.4 -0.8 0"
    radius="0.18"
    color="#00ffff" opacity="0.8">
    <a-text value="Lens" align="center" position="0 0.3 0"></a-text>
  </a-sphere>

  <a-sphere id="retinaBtn" class="clickable part"
    position="1.4 -0.8 0"
    radius="0.18"
    color="#00ffff" opacity="0.8">
    <a-text value="Retina" align="center" position="0 0.3 0"></a-text>
  </a-sphere>

  <a-sphere id="opticBtn" class="clickable part"
    position="0 -1.6 0"
    radius="0.18"
    color="#00ffff" opacity="0.8">
    <a-text value="Optic" align="center" position="0 0.3 0"></a-text>
  </a-sphere>


  <!-- INFO PANEL -->
  <a-plane id="infoPanel"
    position="0 1.9 0"
    width="3.2"
    height="1.4"
    color="#000"
    opacity="0.75"
    visible="false">
  </a-plane>

  <a-text id="infoText"
    position="0 1.9 0.01"
    align="center"
    color="#00ffff"
    wrap-count="40"
    scale="1.4 1.4 1.4"
    visible="false">
  </a-text>

</a-marker>


<a-entity camera>
  <a-cursor raycaster="objects: .clickable" color="#00ffff"></a-cursor>
</a-entity>

</a-scene>



<script>

const model = document.querySelector("#eyeModel");
const infoPanel = document.querySelector("#infoPanel");
const infoText = document.querySelector("#infoText");

let isDragging = false;
let previousX = 0;
let previousY = 0;
let scale = 3;
let startDistance = 0;


// ================= ROTATE + ZOOM =================

window.addEventListener("mousedown", startDrag);
window.addEventListener("mousemove", drag);
window.addEventListener("mouseup", endDrag);

window.addEventListener("touchstart", startDrag, { passive:false });
window.addEventListener("touchmove", drag, { passive:false });
window.addEventListener("touchend", endDrag);


function startDrag(e){

  if(e.touches && e.touches.length === 2){
    startDistance = getDistance(e.touches[0], e.touches[1]);
    return;
  }

  isDragging = true;

  if(e.touches){
    previousX = e.touches[0].clientX;
    previousY = e.touches[0].clientY;
  } else {
    previousX = e.clientX;
    previousY = e.clientY;
  }
}


function drag(e){

  e.preventDefault();

  // PINCH ZOOM
  if(e.touches && e.touches.length === 2){

    let newDistance = getDistance(e.touches[0], e.touches[1]);
    let diff = newDistance - startDistance;

    scale += diff * 0.01;

    if(scale < 1.5) scale = 1.5;
    if(scale > 6) scale = 6;

    model.setAttribute("scale", `${scale} ${scale} ${scale}`);

    startDistance = newDistance;
    return;
  }

  if(!isDragging) return;

  let currentX = e.touches ? e.touches[0].clientX : e.clientX;
  let currentY = e.touches ? e.touches[0].clientY : e.clientY;

  let deltaX = currentX - previousX;
  let deltaY = currentY - previousY;

  let rotation = model.getAttribute("rotation");

  rotation.y += deltaX * 0.6;
  rotation.x += deltaY * 0.6;

  model.setAttribute("rotation", rotation);

  previousX = currentX;
  previousY = currentY;
}


function endDrag(){
  isDragging = false;
}


function getDistance(t1, t2){
  let dx = t1.clientX - t2.clientX;
  let dy = t1.clientY - t2.clientY;
  return Math.sqrt(dx*dx + dy*dy);
}



// ================= INFO DATA =================

const partsInfo = {

  corneaBtn: "Cornea: The transparent front surface that helps focus incoming light.",

  irisBtn: "Iris: The colored part controlling how much light enters the eye.",

  lensBtn: "Lens: Focuses light onto the retina for clear vision.",

  retinaBtn: "Retina: Converts light into electrical signals sent to the brain.",

  opticBtn: "Optic Nerve: Carries visual signals from the eye to the brain."
};



// ================= SPEECH =================

function speak(message){

  window.speechSynthesis.cancel();

  const speech = new SpeechSynthesisUtterance(message);
  speech.rate = 0.9;

  window.speechSynthesis.speak(speech);
}



// ================= SHOW INFO =================

function showInfo(id){

  const message = partsInfo[id];

  infoPanel.setAttribute("visible", true);
  infoText.setAttribute("visible", true);
  infoText.setAttribute("value", message);

  glowEffect(id);

  speak(message);
}



// ================= GLOW =================

function glowEffect(id){

  document.querySelectorAll(".part").forEach(btn=>{
    btn.setAttribute("color","#00ffff");
    btn.setAttribute("scale","1 1 1");
  });

  const selected = document.getElementById(id);

  selected.setAttribute("color","#ffffff");
  selected.setAttribute("scale","1.4 1.4 1.4");
}



// ================= CLICK EVENTS =================

Object.keys(partsInfo).forEach(id => {

  const el = document.getElementById(id);

  el.addEventListener("click", ()=> showInfo(id));

  el.addEventListener("touchstart", e=>{
    e.preventDefault();
    showInfo(id);
  });

});



</script>

</body>
</html>